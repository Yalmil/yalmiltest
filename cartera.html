<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Cartera | Lunas ðŸŒ™</title>

<link rel="icon" href="https://cdn.discordapp.com/emojis/1416607460201857168.png?v=1" type="image/png">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

<meta property="og:title" content="Yalmil.com">
<meta property="og:description" content="Cartera de Lunas del usuario">
<meta property="og:image" content="https://cdn.discordapp.com/attachments/1355008732576088204/1402309070014124102/Screenshot_20250804-221210.png">
<meta property="og:url" content="https://yalmil.github.io/Yalmil.com/">
<meta property="og:type" content="website">

<!-- CSS ORIGINAL SIN CAMBIOS -->
<style>
/* (CSS intacto â€“ omitido aquÃ­ por brevedad, usa exactamente el tuyo) */
</style>
</head>

<body>

<!-- HTML ORIGINAL SIN CAMBIOS -->
<!-- (Todo tu HTML va igual, sin modificar) -->

<script type="module">
const _0x5f2c=_=>atob(_);
import{initializeApp as _0xa1}from"https://www.gstatic.com/firebasejs/9.22.2/firebase-app.js";
import{getAuth as _0xb2,onAuthStateChanged as _0xc3,signOut as _0xd4}from"https://www.gstatic.com/firebasejs/9.22.2/firebase-auth.js";
import{getDatabase as _0xe5,ref as _0xf6,onValue as _0x07,set as _0x18,get as _0x29}from"https://www.gstatic.com/firebasejs/9.22.2/firebase-database.js";

const _0xconfig={
apiKey:_0x5f2c("QUl6YVN5QVpPUmNvZUMzTUZNUFlKV0dsNGRtTmpxLVU1MWRLRDUv"),
authDomain:"databaseloginweb.firebaseapp.com",
databaseURL:"https://databaseloginweb-default-rtdb.firebaseio.com",
projectId:"databaseloginweb",
storageBucket:"databaseloginweb.firebasestorage.app",
messagingSenderId:"121538864529",
appId:"1:121538864529:web:e92aaeaa4ba52618162630"
};

const _0xapp=_0xa1(_0xconfig),
_0xauth=_0xb2(_0xapp),
_0xdb=_0xe5(_0xapp);

let _0xuid=null,_0xlunas=0,_0xbuy=null,_0xinterval=null;

const $=_=>document.getElementById(_),
$lunas=$("lunas"),
$logout=$("logoutBtn"),
$modal=$("confirmModal"),
$confirm=$("confirmBuy"),
$title=$("modalTitle"),
$text=$("modalText"),
$btns=document.querySelectorAll(".buy-btn");

const _update=()=>{_0xbtns()};
const _0xbtns=()=>{$btns.forEach(b=>{const p=+b.dataset.price;
b.disabled=_0xlunas<p;
b.innerHTML=_0xlunas>=p?
`<i class="fas fa-shopping-cart"></i> Canjear por ${p} lunas`:
`<i class="fas fa-lock"></i> Necesitas ${p} lunas`;});};

const _modal=(t,h)=>{_title.textContent=t;_text.innerHTML=h;$modal.classList.add("show");};
window.closeModal=()=>{$modal.classList.remove("show");_0xbuy=null;};

_0xc3(_0xauth,async u=>{
if(!u){location.href="login.html";return;}
_0xuid=u.uid;
const r=_0xf6(_0xdb,`users/${_0xuid}/lunas`);
if(!(await _0x29(r)).exists())await _0x18(r,0);
_0x07(r,s=>{_0xlunas=s.val()||0;$lunas.textContent=_0xlunas;_update();});
});

$logout.onclick=async()=>{await _0xd4(_0xauth);location.href="login.html";};

$btns.forEach(b=>b.onclick=()=>{
const p=+b.dataset.price,n=b.dataset.name;
if(_0xlunas<p)return _modal("Lunas insuficientes",`Necesitas ${p} lunas`);
_0xbuy={p,n};
_modal("Confirmar Canje",`Â¿Canjear <b>${p}</b> lunas por <b>${n}</b>?`);
});

$confirm.onclick=async()=>{
if(!_0xbuy||!_0xuid)return closeModal();
const n=_0xlunas-_0xbuy.p;
await _0x18(_0xf6(_0xdb,`users/${_0xuid}/lunas`),n);
window.open("https://discord.com/users/1282532222305308682","_blank");
_modal("Â¡Compra exitosa!","Contacta por Discord.");
_0xbuy=null;
};

document.addEventListener("keydown",e=>e.key==="Escape"&&closeModal());
$modal.onclick=e=>e.target===$modal&&closeModal();
</script>

</body>
</html>
